# Template test sandbox

This folder exists to serve as an isolated environment for template execution tests.

## Debugging template execution tests

Before running template execution tests, make sure that packages defined in this solution have been packed by running the following commands from the repo root:
```sh
./build.cmd -build
./build.cmd -pack
```

**Note:** These commands currently need to be run separately so that generated template content gets included in the template `.nupkg`.

Template tests can be debugged either in VS or by running `dotnet test`.

However, it's sometimes helpful to debug failures by building, running, and modifying the generated projects directly instead of tinkering with test code.

To help with this scenario:
* The `output/` folder containing the generated projects doesn't get cleared until the start of the next test run.
* An `activate.ps1` script can be used to simulate the environment that the template execution tests use. This script:
  * Sets the active .NET installation to `<repo_root>/.dotnet`.
  * Sets the `NUGET_PACKAGES` environment variable to the `output/packages` folder to use the isolated package cache.
  * Sets a `LOCAL_SHIPPING_PATH` environment variable so that locally-built packages can get picked up during restore.

As an example, here's how you can build a project generated by the tests:
```sh
. ./activate.ps1
cd ./output/[test_collection]/[generated_template]
dotnet build
```
