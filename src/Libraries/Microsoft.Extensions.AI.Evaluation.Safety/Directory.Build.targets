<Project>
  <Import Project="$([MSBuild]::GetPathOfFileAbove('Directory.Build.targets', '$(MSBuildThisFileDirectory)..\'))" />

  <!-- Generate a version constant that can be accessed from the C# code. -->
  <Target Name="GenerateVersionConstant" BeforeTargets="CoreCompile">
    <PropertyGroup>
      <_ConstantsFilePath>$(IntermediateOutputPath)Constants.g.cs</_ConstantsFilePath>
      <_Lines>
// <auto-generated>
// This file is auto-generated by MSBuild.
// </auto-generated>

namespace $(RootNamespace)%3B

internal static class Constants
{
    public const string Version = "$(Version)"%3B
}
      </_Lines>
    </PropertyGroup>

    <Message Text="Generating $(_ConstantsFilePath)." Importance="high" />
    
    <WriteLinesToFile File="$(_ConstantsFilePath)"
                      Lines="$(_Lines)"
                      Overwrite="true"
                      WriteOnlyWhenDifferent="true" />

    <ItemGroup>
      <Compile Include="$(_ConstantsFilePath)" />
    </ItemGroup>
  </Target>
</Project>
