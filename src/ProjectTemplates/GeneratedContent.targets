<Project>

  <PropertyGroup>
    <!--
      Configures which chat template variant to use when debugging locally.
      Options are:
      - singleproject
      - aspire
    -->
    <_LocalChatTemplateVariant>aspire</_LocalChatTemplateVariant>

    <_WebApiAgentRoot>$(MSBuildThisFileDirectory)Microsoft.Agents.AI.ProjectTemplates\src\WebApiAgent\</_WebApiAgentRoot>
    <_ChatWithCustomDataContentRoot>$(MSBuildThisFileDirectory)Microsoft.Extensions.AI.Templates\src\ChatWithCustomData\</_ChatWithCustomDataContentRoot>
    <_McpServerContentRoot>$(MSBuildThisFileDirectory)Microsoft.Extensions.AI.Templates\src\McpServer\</_McpServerContentRoot>
  </PropertyGroup>

  <Target Name="ComputePackageVersionVariableReferences">
    <!--
      Specifies packages defined in this repo that get referenced in generated template content.
      For each item specified below, a property will be generated whose name matches the format:
      "TemplatePackageVersion_{PackageName}"
      where {PackageName} is the package ID with '.' characters removed.
      The value of each property will be the computed package version.
    -->
    <ItemGroup>
      <PackageVersionVariableReference Include="$(RepoRoot)src\Libraries\Microsoft.Extensions.AI\Microsoft.Extensions.AI.csproj"></PackageVersionVariableReference>
      <PackageVersionVariableReference Include="$(RepoRoot)src\Libraries\Microsoft.Extensions.AI.OpenAI\Microsoft.Extensions.AI.OpenAI.csproj"></PackageVersionVariableReference>
      <PackageVersionVariableReference Include="$(RepoRoot)src\Libraries\Microsoft.Extensions.Http.Resilience\Microsoft.Extensions.Http.Resilience.csproj"></PackageVersionVariableReference>
      <PackageVersionVariableReference Include="$(RepoRoot)src\Libraries\Microsoft.Extensions.DataIngestion\Microsoft.Extensions.DataIngestion.csproj"></PackageVersionVariableReference>
      <PackageVersionVariableReference Include="$(RepoRoot)src\Libraries\Microsoft.Extensions.DataIngestion.Markdig\Microsoft.Extensions.DataIngestion.Markdig.csproj"></PackageVersionVariableReference>
      <PackageVersionVariableReference Include="$(RepoRoot)src\Libraries\Microsoft.Extensions.DataIngestion.MarkItDown\Microsoft.Extensions.DataIngestion.MarkItDown.csproj"></PackageVersionVariableReference>
    </ItemGroup>
  </Target>

  <Target Name="ComputeGeneratedContentProperties">
    <!--
      Specifies external packages that get referenced in generated template content.
    -->
    <PropertyGroup>
      <TemplatePackageVersion_MicrosoftAgentsAI>1.0.0-local.251108.1</TemplatePackageVersion_MicrosoftAgentsAI>
      <TemplatePackageVersion_MicrosoftAgentsAIHostingOpenAI>1.0.0-local.251108.1</TemplatePackageVersion_MicrosoftAgentsAIHostingOpenAI>
      <TemplatePackageVersion_Aspire>9.5.1</TemplatePackageVersion_Aspire>
      <TemplatePackageVersion_Aspire_Preview>9.5.1-preview.1.25502.11</TemplatePackageVersion_Aspire_Preview>
      <TemplatePackageVersion_AzureAIProjects>1.0.0</TemplatePackageVersion_AzureAIProjects>
      <TemplatePackageVersion_AzureIdentity>1.17.0</TemplatePackageVersion_AzureIdentity>
      <TemplatePackageVersion_AzureSearchDocuments>11.7.0</TemplatePackageVersion_AzureSearchDocuments>
      <TemplatePackageVersion_CommunityToolkitAspire>9.8.1-beta.413</TemplatePackageVersion_CommunityToolkitAspire>
      <TemplatePackageVersion_MicrosoftExtensionsHosting>10.0.0-rc.2.25502.107</TemplatePackageVersion_MicrosoftExtensionsHosting>
      <TemplatePackageVersion_MicrosoftExtensionsServiceDiscovery>9.5.1</TemplatePackageVersion_MicrosoftExtensionsServiceDiscovery>
      <TemplatePackageVersion_MicrosoftMLTokenizers>2.0.0-preview.25503.2</TemplatePackageVersion_MicrosoftMLTokenizers>
      <TemplatePackageVersion_MicrosoftSemanticKernel>1.67.1</TemplatePackageVersion_MicrosoftSemanticKernel>
      <TemplatePackageVersion_MicrosoftSemanticKernel_Preview>1.67.1-preview</TemplatePackageVersion_MicrosoftSemanticKernel_Preview>
      <TemplatePackageVersion_ModelContextProtocol>0.4.0-preview.1</TemplatePackageVersion_ModelContextProtocol>
      <TemplatePackageVersion_OllamaSharp>5.4.8</TemplatePackageVersion_OllamaSharp>
      <TemplatePackageVersion_OpenTelemetry>1.13.0</TemplatePackageVersion_OpenTelemetry>
      <TemplatePackageVersion_PdfPig>0.1.11</TemplatePackageVersion_PdfPig>
      <TemplatePackageVersion_SystemLinqAsync>6.0.3</TemplatePackageVersion_SystemLinqAsync>
    </PropertyGroup>

    <PropertyGroup>
      <!-- Specify package version variables used in template content. -->
      <GeneratedContentProperties>
        $(GeneratedContentProperties);

        <!-- Repo properties -->
        ArtifactsShippingPackagesDir=$(ArtifactsShippingPackagesDir);

        <!-- Package version properties -->
        TemplatePackageVersion_MicrosoftAgentsAI=$(TemplatePackageVersion_MicrosoftAgentsAI);
        TemplatePackageVersion_MicrosoftAgentsAIHostingOpenAI=$(TemplatePackageVersion_MicrosoftAgentsAIHostingOpenAI);
        TemplatePackageVersion_Aspire=$(TemplatePackageVersion_Aspire);
        TemplatePackageVersion_Aspire_Preview=$(TemplatePackageVersion_Aspire_Preview);
        TemplatePackageVersion_AzureAIProjects=$(TemplatePackageVersion_AzureAIProjects);
        TemplatePackageVersion_AzureIdentity=$(TemplatePackageVersion_AzureIdentity);
        TemplatePackageVersion_AzureSearchDocuments=$(TemplatePackageVersion_AzureSearchDocuments);
        TemplatePackageVersion_CommunityToolkitAspire=$(TemplatePackageVersion_CommunityToolkitAspire);
        TemplatePackageVersion_MicrosoftExtensionsHosting=$(TemplatePackageVersion_MicrosoftExtensionsHosting);
        TemplatePackageVersion_MicrosoftExtensionsServiceDiscovery=$(TemplatePackageVersion_MicrosoftExtensionsServiceDiscovery);
        TemplatePackageVersion_MicrosoftMLTokenizers=$(TemplatePackageVersion_MicrosoftMLTokenizers);
        TemplatePackageVersion_MicrosoftSemanticKernel=$(TemplatePackageVersion_MicrosoftSemanticKernel);
        TemplatePackageVersion_MicrosoftSemanticKernel_Preview=$(TemplatePackageVersion_MicrosoftSemanticKernel_Preview);
        TemplatePackageVersion_ModelContextProtocol=$(TemplatePackageVersion_ModelContextProtocol);
        TemplatePackageVersion_OllamaSharp=$(TemplatePackageVersion_OllamaSharp);
        TemplatePackageVersion_OpenTelemetry=$(TemplatePackageVersion_OpenTelemetry);
        TemplatePackageVersion_PdfPig=$(TemplatePackageVersion_PdfPig);
        TemplatePackageVersion_SystemLinqAsync=$(TemplatePackageVersion_SystemLinqAsync);

        <!-- Other properties -->
        LocalChatTemplateVariant=$(_LocalChatTemplateVariant);
      </GeneratedContentProperties>
    </PropertyGroup>

    <ItemGroup>
      <GeneratedContent
        Include="$(_WebApiAgentRoot)WebApiAgent-CSharp\WebApiAgent-CSharp.csproj.in"
        OutputPath="$(_WebApiAgentRoot)WebApiAgent-CSharp\WebApiAgent-CSharp.csproj" />
      <GeneratedContent
        Include="$(_ChatWithCustomDataContentRoot)ChatWithCustomData-CSharp.sln.in"
        OutputPath="$(_ChatWithCustomDataContentRoot)ChatWithCustomData-CSharp.sln" />
      <GeneratedContent
        Include="$(_ChatWithCustomDataContentRoot)Directory.Build.targets.in"
        OutputPath="$(_ChatWithCustomDataContentRoot)Directory.Build.targets" />
      <GeneratedContent
        Include="$(_ChatWithCustomDataContentRoot)Directory.Build.props.in"
        OutputPath="$(_ChatWithCustomDataContentRoot)Directory.Build.props" />
      <GeneratedContent
        Include="$(_ChatWithCustomDataContentRoot)ChatWithCustomData-CSharp.Web\ChatWithCustomData-CSharp.Web.csproj.in"
        OutputPath="$(_ChatWithCustomDataContentRoot)ChatWithCustomData-CSharp.Web\ChatWithCustomData-CSharp.Web.csproj" />
      <GeneratedContent
        Include="$(_ChatWithCustomDataContentRoot)ChatWithCustomData-CSharp.Web\Directory.Build.targets.in"
        OutputPath="$(_ChatWithCustomDataContentRoot)ChatWithCustomData-CSharp.Web\Directory.Build.targets" />
      <GeneratedContent
        Include="$(_ChatWithCustomDataContentRoot)ChatWithCustomData-CSharp.AppHost\ChatWithCustomData-CSharp.AppHost.csproj.in"
        OutputPath="$(_ChatWithCustomDataContentRoot)ChatWithCustomData-CSharp.AppHost\ChatWithCustomData-CSharp.AppHost.csproj" />
      <GeneratedContent
        Include="$(_ChatWithCustomDataContentRoot)ChatWithCustomData-CSharp.ServiceDefaults\ChatWithCustomData-CSharp.ServiceDefaults.csproj.in"
        OutputPath="$(_ChatWithCustomDataContentRoot)ChatWithCustomData-CSharp.ServiceDefaults\ChatWithCustomData-CSharp.ServiceDefaults.csproj" />
      <GeneratedContent
        Include="$(_McpServerContentRoot)McpServer-CSharp\McpServer-CSharp.csproj.in"
        OutputPath="$(_McpServerContentRoot)McpServer-CSharp\McpServer-CSharp.csproj" />
      <GeneratedContent
        Include="$(_ChatWithCustomDataContentRoot)NuGet.config.in"
        OutputPath="$(_ChatWithCustomDataContentRoot)NuGet.config" />
    </ItemGroup>
  </Target>

</Project>
